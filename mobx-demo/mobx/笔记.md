https://zh.mobx.js.org/react-integration.htmlå®˜ç½‘

# æ ¸å¿ƒï¼š

åˆ›å»ºå¯è§‚å¯Ÿçš„çŠ¶æ€stateï¼š

å±æ€§ï¼Œå®Œæ•´çš„å¯¹è±¡ï¼Œæ•°ç»„ï¼ŒMaps å’Œ Sets éƒ½å¯ä»¥è¢«è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ã€‚mapså’Œsetsè‡ªåŠ¨è½¬åŒ–æˆè§‚å¯Ÿå¯¹è±¡

**observable**ï¼šå®šä¹‰ä¸€ä¸ªå­˜å‚¨stateçš„å¯è¿½è¸ªçš„å­—æ®µ

**action**ï¼šå°†ä¸€ä¸ªæ–¹æ³•æ ‡è®°æˆå¯ä¿®æ”¹sateçš„action

**computed**ï¼šæ ‡è®°ä¸€ä¸ªå¯ä»¥ç”±stateæ´¾ç”Ÿå‡ºçš„æ–°çš„å€¼ï¼Œä¸”ç¼“å­˜å…¶è¾“å‡ºçš„getter

# makeObservableï¼š

- `makeObservable(target, annotations?, options?)` ç›®æ ‡ï¼Œæ³¨é‡Šï¼Œé€‰é¡¹

- æ•è·*å·²ç»å­˜åœ¨*çš„å¯¹è±¡å±æ€§å¹¶ä¸”ä½¿å¾—å®ƒä»¬å¯è§‚å¯Ÿã€‚ä»»ä½• JavaScript å¯¹è±¡ï¼ˆåŒ…æ‹¬ç±»çš„å®ä¾‹ï¼‰éƒ½å¯ä»¥ä½œä¸º `target` è¢«ä¼ é€’ç»™è¿™ä¸ªå‡½æ•°

- åœ¨ç±»ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯thisã€‚`annotations` å‚æ•°å°†ä¼šä¸ºæ¯ä¸€ä¸ªæˆå‘˜æ˜ å°„ [æ³¨è§£](https://zh.mobx.js.org/observable-state.html#å¯ç”¨çš„æ³¨è§£)ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½¿ç”¨ [è£…é¥°å™¨](https://zh.mobx.js.org/enabling-decorators.html) æ—¶ï¼Œ`annotations` å‚æ•°å°†ä¼šè¢«å¿½ç•¥

  

```javascript
import { makeObservable, observable, computed, action } from "mobx"
class Doubler {
    value
    constructor(value) {
        makeObservable(this, {
            value: observable,
            double: computed,
            increment: action,
            fetch: flow
        })
        this.value = value
    }
    get double() {
        return this.value * 2
    }
    increment() {
        this.value++
    }
    *fetch() {
        const response = yield fetch("/api/value")
        this.value = response.json()
    }
}
æ‰€æœ‰å¸¦æ³¨è§£ çš„å­—æ®µéƒ½æ˜¯ ä¸å¯é…ç½®çš„ã€‚
æ‰€æœ‰çš„ä¸å¯è§‚å¯Ÿï¼ˆæ— çŠ¶æ€ï¼‰çš„å­—æ®µï¼ˆaction, flowï¼‰éƒ½æ˜¯ ä¸å¯å†™çš„ã€‚
```

# makeAutoObservable

- `makeAutoObservable(target, overrides?, options?)`
- åŠ å¼ºç‰ˆçš„ `makeObservable`ä¸ä½¿ç”¨ `makeObservable` ç›¸æ¯”ï¼Œ`makeAutoObservable` å‡½æ•°æ›´ç´§å‡‘ï¼Œä¹Ÿæ›´å®¹æ˜“ç»´æŠ¤
- `makeAutoObservable` ä¸èƒ½è¢«ç”¨äºå¸¦æœ‰ super çš„ç±»æˆ– [å­ç±»](https://zh.mobx.js.org/subclassing.html)ã€‚

æ¨æ–­è§„åˆ™ï¼š

- æ‰€æœ‰ *è‡ªæœ‰* å±æ€§éƒ½æˆä¸º `observable`ã€‚
- æ‰€æœ‰ `get`ters éƒ½æˆä¸º `computed`ã€‚
- æ‰€æœ‰ `set`ters éƒ½æˆä¸º `action`ã€‚
- æ‰€æœ‰ *prototype ä¸­çš„ functions* éƒ½æˆä¸º `autoAction`ã€‚
- æ‰€æœ‰ *prototype ä¸­çš„ generator functions* éƒ½æˆä¸º `flow`ã€‚ï¼ˆéœ€è¦æ³¨æ„ï¼Œgenerators å‡½æ•°åœ¨æŸäº›ç¼–è¯‘å™¨é…ç½®ä¸­æ— æ³•è¢«æ£€æµ‹åˆ°ï¼Œå¦‚æœ flow æ²¡æœ‰æ­£å¸¸è¿è¡Œï¼Œè¯·åŠ¡å¿…æ˜ç¡®åœ°æŒ‡å®š `flow` æ³¨è§£ã€‚ï¼‰
- åœ¨ `overrides` å‚æ•°ä¸­æ ‡è®°ä¸º `false` çš„æˆå‘˜å°†ä¸ä¼šè¢«æ·»åŠ æ³¨è§£ã€‚ä¾‹å¦‚ï¼Œå°†å…¶ç”¨äºåƒæ ‡è¯†ç¬¦è¿™æ ·çš„åªè¯»å­—æ®µã€‚

```javascript
import { makeAutoObservable } from "mobx"
function createDoubler(value) {
    return makeAutoObservable({
        value,
        get double() {
            return this.value * 2
        },
        increment() {
            this.value++
        }
    })
}
```

# observable

- `observable(source, overrides?, options?)`
- å°†æ•´ä¸ªå¯¹è±¡å˜æˆå¯è§‚å¯Ÿçš„ã€‚ `source` å¯¹è±¡å°†ä¼šè¢«å…‹éš†å¹¶ä¸”æ‰€æœ‰çš„æˆå‘˜éƒ½å°†ä¼šæˆä¸ºå¯è§‚å¯Ÿçš„ï¼Œç±»ä¼¼äº `makeAutoObservable` åšçš„é‚£æ ·ã€‚
- ç”± `observable` è¿”å›çš„å¯¹è±¡å°†ä¼šä½¿ç”¨ Proxy åŒ…è£…ï¼Œè¿™æ„å‘³ç€ä¹‹åè¢«æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸­çš„å±æ€§ä¹Ÿå°†è¢«ä¾¦æµ‹å¹¶ä½¿å…¶è½¬åŒ–ä¸ºå¯è§‚å¯Ÿå¯¹è±¡ï¼ˆ

# Actions

ä½¿ç”¨ actions æ›´æ–° state,  å°½ç®¡ [`makeAutoObservable`](https://zh.mobx.js.org/observable-state.html#makeautoobservable) å¯ä»¥è‡ªåŠ¨å¸®ä½ å£°æ˜ä¸€éƒ¨åˆ† actionsï¼Œä½†æ˜¯ MobX è¿˜æ˜¯è¦æ±‚ä½ å£°æ˜ä½ çš„ actionsã€‚

ç”¨æ³•ï¼š

- `action` *ï¼ˆæ³¨è§£ï¼‰*

- `action(fn)`

- `action(name, fn)`

- é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å…è®¸åœ¨ actions ä¹‹å¤–æ”¹å˜ stateã€‚è¿™æœ‰åŠ©äºåœ¨ä»£ç ä¸­æ¸…æ¥šåœ°å¯¹çŠ¶æ€æ›´æ–°å‘ç”Ÿçš„ä½ç½®è¿›è¡Œå®šä½ã€‚

- `action` æ³¨è§£åº”è¯¥ä»…ç”¨äºä¼š*ä¿®æ”¹* state çš„å‡½æ•°ã€‚æ´¾ç”Ÿå…¶ä»–ä¿¡æ¯ï¼ˆæ‰§è¡ŒæŸ¥è¯¢æˆ–è€…è¿‡æ»¤æ•°æ®ï¼‰çš„å‡½æ•°*ä¸åº”è¯¥*è¢«æ ‡è®°ä¸º actionsï¼Œä»¥ä¾¿ MobX å¯ä»¥å¯¹å®ƒä»¬çš„è°ƒç”¨è¿›è¡Œè·Ÿè¸ªã€‚

  

```javascript
import { observable, action } from "mobx"
const state = observable({ value: 0 })
const increment = action(state => {
    state.value++
    state.value++
})
increment(state)
```

## action.bound

ç”¨æ³•ï¼š`action.bound` *ï¼ˆæ³¨è§£ï¼‰*`action.bound` æ³¨è§£å¯ç”¨äºå°†æ–¹æ³•è‡ªåŠ¨ç»‘å®šåˆ°æ­£ç¡®çš„å®ä¾‹ï¼Œè¿™æ · `this` ä¼šå§‹ç»ˆè¢«æ­£ç¡®ç»‘å®šåœ¨å‡½æ•°å†…éƒ¨ã€‚

**æç¤ºï¼š** ä½¿ç”¨ `makeAutoObservable(o, {}, { autoBind: true })` è‡ªåŠ¨ç»‘å®šæ‰€æœ‰çš„ actions å’Œ flows

```javascript
import { makeAutoObservable } from "mobx"
class Doubler {
    value = 0
    constructor(value) {
        makeAutoObservable(this, {}, { autoBind: true })
    }
    increment() {
        this.value++
        this.value++
    }
    *flow() {
        const response = yield fetch("http://example.com/value")
        this.value = yield response.json()
    }
}
```



## runInAction

ç”¨æ³•ï¼š

- `runInAction(fn)`

ä½¿ç”¨è¿™ä¸ªå·¥å…·å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªä¼šè¢«ç«‹å³è°ƒç”¨çš„ä¸´æ—¶ actionã€‚åœ¨å¼‚æ­¥è¿›ç¨‹ä¸­éå¸¸æœ‰ç”¨ã€‚ 

```javascript
import** { observable, runInAction } **from** "mobx"
**const** state = observable({ value: 0 })
runInAction(() => {
    state.value++
    state.value++
})
```

## å¼‚æ­¥ actions

ä»æœ¬è´¨ä¸Šè®²ï¼Œå¼‚æ­¥è¿›ç¨‹åœ¨ MobX ä¸­ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šå¤„ç†ï¼Œå› ä¸ºä¸è®ºæ˜¯ä½•æ—¶å¼•å‘çš„æ‰€æœ‰ reactions éƒ½å°†ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ è€Œä¸”å› ä¸ºå¯è§‚å¯Ÿå¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå› æ­¤åœ¨ action æ‰§è¡Œè¿‡ç¨‹ä¸­ä¿æŒå¯¹å®ƒä»¬çš„å¼•ç”¨ä¸€èˆ¬æ˜¯å®‰å…¨çš„ã€‚ ç„¶è€Œï¼Œåœ¨å¼‚æ­¥è¿›ç¨‹ä¸­æ›´æ–°å¯è§‚å¯Ÿå¯¹è±¡çš„æ¯ä¸ªæ­¥éª¤ï¼ˆtickï¼‰éƒ½åº”è¯¥è¢«æ ‡è¯†ä¸º `action`ã€‚ 

1.runInActionsæ–¹å¼

```js
async fetchProjects() {
        this.githubProjects = []
        this.state = "pending"
        try {
            const projects = await fetchGithubProjectsSomehow()
            const filteredProjects = somePreprocessing(projects)
            runInAction(() => {
                this.githubProjects = filteredProjects
                this.state = "done"
            })
        } catch (e) {
            runInAction(() => {
                this.state = "error"
            })
        }
    }
```

2.ä½¿ç”¨ flow ä»£æ›¿ async / await {ğŸš€}

ç”¨æ³•ï¼š

- `flow` *ï¼ˆæ³¨è§£ï¼‰*

- `flow(function* (args) { })`

-  flow æœºåˆ¶å°†ä¼šç¡®ä¿ generator åœ¨ Promise resolve ä¹‹åç»§ç»­è¿è¡Œæˆ–è€…æŠ›å‡ºé”™è¯¯ã€‚

- `flow` å°†ä¸€ä¸ª [generator å‡½æ•°](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator) ä½œä¸ºå”¯ä¸€è¾“å…¥ã€‚ åœ¨ generator å†…éƒ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ yield ä¸²è” Promiseï¼ˆä½¿ç”¨ `yield somePromise` ä»£æ›¿ `await somePromise`ï¼‰ã€‚

- æ‰€ä»¥ `flow` æ˜¯ `async` / `await` çš„ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œä¸éœ€è¦å†ç”¨ `action` è¿›è¡ŒåŒ…è£…ã€‚å®ƒå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼ä½¿ç”¨ï¼š

  > 1. ä½¿ç”¨ `flow` åŒ…è£…ä½ çš„å¼‚æ­¥å‡½æ•°ã€‚
  > 2. ä½¿ç”¨ `function *` ä»£æ›¿ `async`ã€‚
  > 3. ä½¿ç”¨ `yield` ä»£æ›¿ `await`ã€‚

  

```js
import { flow, makeAutoObservable, flowResult } from "mobx"
class Store {
    githubProjects = []
    state = "pending"
    constructor() {
        makeAutoObservable(this, {
            fetchProjects: flow
        })
    }
    // æ³¨æ„æ˜Ÿå·, è¿™æ˜¯ä¸€ä¸ª generator å‡½æ•°!
    *fetchProjects() {
        this.githubProjects = []
        this.state = "pending"
        try {
            // Yield ä»£æ›¿ await.
            const projects = yield fetchGithubProjectsSomehow()
            const filteredProjects = somePreprocessing(projects)
            this.state = "done"
            this.githubProjects = filteredProjects
        } catch (error) {this.state = "error"}}}
const store = new Store()
const projects = await flowResult(store.fetchProjects())
```

## `flow.bound`

ç”¨æ³•ï¼š

- `flow.bound` *ï¼ˆæ³¨è§£ï¼‰*

`flow.bound` æ³¨è§£å¯ç”¨äºå°†æ–¹æ³•è‡ªåŠ¨ç»‘å®šåˆ°æ­£ç¡®çš„å®ä¾‹ï¼Œè¿™æ · `this` ä¼šå§‹ç»ˆè¢«æ­£ç¡®ç»‘å®šåœ¨å‡½æ•°å†…éƒ¨ã€‚ ä¸ actions ä¸€æ ·ï¼Œflows é»˜è®¤å¯ä»¥ä½¿ç”¨ [`autoBind` é€‰é¡¹](https://zh.mobx.js.org/actions.html#auto-bind)ã€‚

## å–æ¶ˆ flows {ğŸš€}

flow çš„å¦ä¸€ä¸ªå¥½å¤„å°±æ˜¯å®ƒå¯ä»¥è¢«å–æ¶ˆã€‚ `flow` çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª Promiseï¼Œåœ¨ generator å‡½æ•°è¿è¡Œå®Œæˆæ—¶å®ƒå°†ä¼šè¢« resolveã€‚ è¿”å›çš„ Promise ä¸­è¿˜æœ‰ä¸€ä¸ª `cancel()` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æ‰“æ–­æ­£åœ¨è¿è¡Œçš„ generator å¹¶å–æ¶ˆå®ƒã€‚ æ‰€æœ‰ `try` / `finally` è¯­å¥ä»ç„¶ä¼šè¢«è¿è¡Œã€‚

# computeds 

è®¡ç®—å€¼å¯ä»¥ç”¨æ¥ä»å…¶ä»–å¯è§‚å¯Ÿå¯¹è±¡ä¸­æ´¾ç”Ÿä¿¡æ¯ã€‚ è®¡ç®—å€¼é‡‡ç”¨æƒ°æ€§æ±‚å€¼ï¼Œä¼šç¼“å­˜å…¶è¾“å‡ºï¼Œå¹¶ä¸”åªæœ‰å½“å…¶ä¾èµ–çš„å¯è§‚å¯Ÿå¯¹è±¡è¢«æ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—

ä½¿ç”¨ï¼š

- `computed` *ï¼ˆæ³¨è§£ï¼‰*
- `computed(options)` *ï¼ˆæ³¨è§£ï¼‰*
- `computed(fn, options?)`

## Options {ğŸš€}

1. `name`ï¼šè°ƒè¯•ç”¨

   `equals`ï¼šé»˜è®¤è®¾ç½®ä¸º `comparer.default`ã€‚å®ƒå……å½“ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ï¼Œç”¨äºæ¯”è¾ƒä¸Šä¸€ä¸ªå€¼å’Œä¸‹ä¸€ä¸ªå€¼ã€‚å¦‚æœè¯¥å‡½æ•°è®¤ä¸ºä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œé‚£ä¹ˆè§‚å¯Ÿè€…ä»¬å°†ä¸ä¼šè¢«é‡æ–°è®¡ç®—ã€‚

2. å†…ç½® comparers

MobX æä¾›äº†å››ç§å†…ç½®çš„ `comparer` æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•æ»¡è¶³ `computed` çš„ `equals` é€‰é¡¹çš„å¤§å¤šæ•°éœ€æ±‚ï¼š

- `comparer.identity` ä½¿ç”¨å…¨ç­‰ ï¼ˆ`===`ï¼‰è¿ç®—ç¬¦ç¡®å®šä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒã€‚
- `comparer.default` ä¸ `comparer.identity` ç›¸åŒï¼Œä½†æ˜¯å…¶è®¤ä¸º `NaN` ç­‰äº `NaN`ã€‚
- `comparer.structural` æ‰§è¡Œæ·±å±‚çš„ç»“æ„æ¯”è¾ƒä»¥ç¡®å®šä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒã€‚
- `comparer.shallow` æ‰§è¡Œæµ…å±‚çš„ç»“æ„æ¯”è¾ƒä»¥ç¡®å®šä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒã€‚

3. `requiresReaction`ï¼šæ¨èåœ¨éå¸¸æ˜‚è´µçš„è®¡ç®—å€¼ä¸­å°†è¿™ä¸ªé€‰é¡¹è®¾ç½®ä¸º `true`

4. ` `keepAlive`ï¼šè¿™ä¸ªé€‰é¡¹ä¼šé¿å…è®¡ç®—å€¼åœ¨æœªè¢«è§‚å¯Ÿæ—¶è¢«æš‚æ—¶åœç”¨

# reactions 

ä½¿ç”¨ reactions å¤„ç†å‰¯ä½œç”¨ {ğŸš€}

> å¦‚ä½•åˆ›å»º reactionsã€‚ æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ [`autorun`](https://zh.mobx.js.org/reactions.html#autorun) å·¥å…·å‡½æ•°ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ [`reaction`](https://zh.mobx.js.org/reactions.html#reaction) å’Œ [`when`](https://zh.mobx.js.org/reactions.html#when)ã€‚

# mobx-react-lite

# observer

```js
//è¢«`observer`åŒ…è£¹çš„å‡½æ•°å¼ç»„ä»¶ä¼šè¢«ç›‘å¬åœ¨å®ƒæ¯ä¸€æ¬¡è°ƒç”¨å‰å‘ç”Ÿçš„ä»»ä½•å˜åŒ–
import { observer } from "mobx-react-lite"
const TimerView = observer(({ timer }) => <span>Seconds passed: {timer.secondsPassed}</span>)
```

1. `observer` HOC å°†è‡ªåŠ¨è®¢é˜… React components ä¸­ä»»ä½• *åœ¨æ¸²æŸ“æœŸé—´* è¢«ä½¿ç”¨çš„ *å¯è¢«è§‚å¯Ÿçš„å¯¹è±¡* ã€‚
2.  å› æ­¤, å½“ä»»ä½•å¯è¢«è§‚å¯Ÿçš„å¯¹è±¡ *å˜åŒ–* å‘ç”Ÿæ—¶å€™ ç»„ä»¶ä¼šè‡ªåŠ¨è¿›è¡Œé‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ã€‚ 
3. å®ƒè¿˜ä¼šç¡®ä¿ç»„ä»¶åœ¨ *æ²¡æœ‰å˜åŒ–* å‘ç”Ÿçš„æ—¶å€™ä¸ä¼šè¿›è¡Œé‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ã€‚
4.  ä½†æ˜¯, æ›´æ”¹ç»„ä»¶çš„å¯è§‚å¯Ÿå¯¹è±¡çš„ä¸å¯è¯»å±æ€§, ä¹Ÿä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ã€‚

```js
import { observer } from "mobx-react-lite"
import { observable } from "mobx"
import { useState } from "react"
const TimerView = observer(() => {
    const [timer] = useState(() =>
        observable({
            secondsPassed: 0,
            increaseTimer() {
                this.secondsPassed++}}))
    return <span>Seconds passed: {timer.secondsPassed}</span>})
ReactDOM.render(<TimerView />, document.body)
```

`const [store] = useState(() => observable({ /* something */}))` æ˜¯éå¸¸é€šç”¨çš„ä¸€å¥—å†™æ³•ï¼Œ ä¸ºäº†ç®€åŒ–è¿™ä¸ªå†™æ³•æˆ‘ä»¬å¯ä»¥è°ƒç”¨`mobx-react-lite` åŒ…ä¸­çš„ [`useLocalObservable`](https://github.com/mobxjs/mobx-react#uselocalobservable-hook) hook ,å¯ä»¥å°†ä¸Šé¢çš„ä¾‹å­ç®€åŒ–æˆï¼š

```js
import { observer, useLocalObservable } from "mobx-react-lite"
import { useState } from "react"
const TimerView = observer(() => {
    const timer = useLocalObservable(() => ({
        secondsPassed: 0,
        increaseTimer() {this.secondsPassed++}}))
    return <span>Seconds passed: {timer.secondsPassed}</span>
})
ReactDOM.render(<TimerView />, document.body)
```

çŠ¶æ€ç±»ä¼¼è·å–UI state, ç±»ä¼¼åŠ è½½çš„ state, é€‰æ‹©çš„ state,ç­‰ç­‰, æœ€å¥½è¿˜æ˜¯ä½¿ç”¨ [`useState` hook](https://reactjs.org/docs/hooks-state.html), è¿™æ ·å¯ä»¥è®©ä½ ä½¿ç”¨é«˜çº§çš„ React suspenseç‰¹æ€§ã€‚

ä½¿ç”¨Mobxçš„å¯è§‚å¯Ÿèƒ½åŠ›ä½œä¸º React components çš„ä¸€ç§çŠ¶æ€è¡¥å……ï¼Œæ¯”å¦‚å‡ºç°ä»¥ä¸‹æƒ…å†µï¼š 1) å±‚çº§å¾ˆæ·±, 2) æ‹¥æœ‰è®¡ç®—å±æ€§ 3) éœ€è¦å…±äº«çŠ¶æ€ç»™å…¶å®ƒ `observer` componentsã€‚

### ä¸è¦å°†å¯è§‚å¯Ÿå¯¹è±¡ä¼ é€’åˆ° ä¸æ˜¯`observer`çš„ç»„ä»¶ä¸­

```js
class Todo {
    title = "test"
    done = true

    constructor() {
        makeAutoObservable(this)
    }
}

const TodoView = observer(({ todo }: { todo: Todo }) =>
   // é”™è¯¯: GridRow ä¸èƒ½è·å–åˆ° todo.title/ todo.done çš„å˜æ›´
   //       å› ä¸ºä»–ä¸æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼ˆobserverã€‚
   return <GridRow data={todo} />

   // æ­£ç¡®:åœ¨ `TodoView` ä¸­æ˜¾å¼çš„å£°æ˜ç›¸å…³çš„`todo` ï¼Œ
   //      åˆ°dataä¸­ã€‚
   return <GridRow data={{
       title: todo.title,
       done: todo.done
   }} />

   // æ­£ç¡®: ä½¿ç”¨ `toJS`ä¹Ÿæ˜¯å¯ä»¥çš„, å¹¶ä¸”æ˜¯æ›´æ¸…æ™°ç›´ç™½çš„æ–¹å¼ã€‚
   return <GridRow data={toJS(todo)} />
)
```

### å›è°ƒç»„ä»¶å¯èƒ½ä¼šéœ€è¦`<Observer>`

```js
const TodoView = observer(({ todo }: { todo: Todo }) => {
    // é”™è¯¯: GridRow.onRender ä¸èƒ½è·å¾— todo.title / todo.done ä¸­çš„æ”¹å˜
    //        å› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼ˆobserverï¼‰ ã€‚
    return <GridRow onRender={() => <td>{todo.title}</td>} />

    // æ­£ç¡®: å°†å›è°ƒç»„ä»¶é€šè¿‡ObserveråŒ…è£¹å°†ä¼šæ­£ç¡®çš„è·å¾—å˜åŒ–ã€‚
    return <GridRow onRender={() => <Observer>{() => <td>{todo.title}</td>}</Observer>} />
})
```

